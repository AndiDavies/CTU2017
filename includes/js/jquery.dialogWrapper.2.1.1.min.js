/*! dialogWrapper - v2.1.1 - 2012-06-03
* https://bitbucket.org/MostThingsWeb/dialogwrapper
* Copyright (c) 2012 MostThingsWeb (Chris Laplante); Licensed MIT */
(function(a){function b(){var a="";for(var b=1;b<=10;b++)a+=Math.floor(Math.random()*10)+1;return a}function c(b){var c=0,d;return b.each(function(){var b=a(this).parent();b.css("z-index")>c&&(d=b,c=b.css("z-index"))}),d}if(a.dW)return;a.dW={};if(!a.ui||!a.ui.dialog)return;a.ui.dialog.prototype.options.hasClose=!0,a.ui.dialog.prototype.destroy=function(){var a=this;return a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle),a};var d=a.ui.dialog.prototype._create;a.ui.dialog.prototype._create=function(){d.apply(this);var a=this.options;!a.dynamicallyCreated&&a.modal&&this.uiDialog.attr("modal",!0)},a.ui.dialog.prototype.close=function(b){var d=this,e,f;if(!1===d._trigger("beforeClose",b))return;if(d.uiDialog.find(".ui-dialog-content").is("[modal=true]")){var g=a(".ui-dialog-content:visible[modal=true]").not(d.uiDialog.find(".ui-dialog-content")),h=g.size();h>0?a(".ui-widget-overlay").css("z-index",parseInt(c(g).css("z-index"),10)-1):a(".ui-widget-overlay").remove()}return a([document,window]).unbind(".dialog-overlay"),d.uiDialog.unbind("keypress.ui-dialog"),d._isOpen=!1,d.options.hide?d.uiDialog.hide(d.options.hide,function(){d._trigger("close",b)}):(d.uiDialog.hide(),d._trigger("close",b)),a.ui.dialog.overlay.resize(),d.options.modal&&(e=0,a(".ui-dialog").each(function(){this!==d.uiDialog[0]&&(f=a(this).css("z-index"),isNaN(f)||(e=Math.max(e,f)))}),a.ui.dialog.maxZ=e),d},a.ui.dialog.prototype._titlebarClose=null;var e=a.ui.dialog.prototype._setOption;a.ui.dialog.prototype._setOption=function(b,c){var d=this,f=d.uiDialog;if(b==="hasClose"){if(!d.options.dynamicallyCreated)return;if(c===d.options.hasClose)return;c?f.find(".ui-dialog-titlebar").append(d._titlebarClose):d._titlebarClose=f.find(".ui-dialog-titlebar-close").detach()}else e.call(this,b,c);a.Widget.prototype._setOption.apply(d,arguments)},a.dW=a.extend({version:"2.1",getTopDialog:function(){var b=a(".ui-dialog-content:visible");return b.size()===0?null:b.size()===1?b[0]:c(b)},findDialog:function(b){if(!b)return this.getTopDialog();if(!(b instanceof Object))if(b.constructor===Number)b=a("#"+String(b));else if(b.constructor===String)/^#/.test(b)||(b="#"+b),b=a(b);else return!1;return b.jquery||(b=a(b)),b.size()===0?!1:b},createDialog:function(){var c="",d,e=null;switch(arguments.length){case 1:d=arguments[0];break;case 2:d=arguments[0],e=arguments[1];break;case 3:c=arguments[0],d=arguments[1],e=arguments[2]}var f={title:c,id:"dWd"+b()};f=a.extend(!0,{},a.ui.dialog.prototype.options,f,e),f.dynamicallyCreated=!0,a("body").append("<div id='"+f.id+"'><p>"+d+"</p></div>");var g=a("#"+f.id).dialog(f),h=g.data("dialog");a(".ui-widget-overlay").size()>1&&a(".ui-widget-overlay:first").remove();var i=this;return g.find(".ui-dialog-titlebar-close").unbind("click").attr("href","javascript: void false").click(function(){i.destroyDialog(g.find(".ui-dialog-content"))}),f.hasClose||(h._titlebarClose=g.parent().find(".ui-dialog-titlebar-close").detach()),f.modal&&g.attr("modal","true"),g},hideDialog:function(b,c){var d={hide:null};return a.extend(d,c),b=this.findDialog(b),b?(d.hide&&b.dialog("option","hide",d.hide),b.dialog("close"),!0):!1},hideDialogs:function(){var b=!0,c=this;return a(".ui-dialog-content:visible").each(function(){c.hideDialog(a(this))||(b=!1)}),b},destroyDialogs:function(b){b===null&&(b=!0);var c=!0,d=this;return a(".ui-dialog-content:visible").each(function(){d.destroyDialog(a(this),{remove:b})||(c=!1)}),c},destroyDialog:function(b,c){var d={remove:!0,hide:null};return a.extend(d,c),b=this.findDialog(b),b?this.hideDialog(b,c)?(b.bind("dialogclose",function(){a(b).dialog("destroy"),d.remove&&a(b).remove()}),!0):!1:!1},confirm:function(b,c,d,e){if(!c||!d)return null;e=e||{};var f=this;return this.createDialog("Confirm",b,a.extend(!0,{buttons:{No:function(){(d||a.noop).apply(this),f.destroyDialog(this)},Yes:function(){(c||a.noop).apply(this),f.destroyDialog(this)}}},e))},alert:function(b,c,d){c=c||{};var e=this;return this.createDialog("Info",b,a.extend(!0,{buttons:{Ok:function(){e.destroyDialog(this),(d||a.noop).apply(this)}}},c))},input:function(c,d,e){if(!e)return null;d=d||{};var f=this,g=b(),h=this.createDialog("Input",c+"<br/><br/><input id='"+g+"' style='width: 100%;' type='text'/>",a.extend(!0,{buttons:{Ok:function(){e.call(this,a("#"+g).val()),f.destroyDialog(this)}}},d));return a("#"+g).val(d.defaultValue),h},classicMode:function(){a.getTopDialog=this.getTopDialog,a.findDialog=this.findDialog,a.createDialog=this.createDialog,a.hideDialog=this.hideDialog,a.hideDialogs=this.hideDialogs,a.destroyDialog=this.destroyDialog,a.destroyDialogs=this.destroyDialogs,a.alert=this.alert,a.confirm=this.confim,a.input=this.input}},a.dW)})(jQuery);